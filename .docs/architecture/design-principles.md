# 設計原則

> 鳴門市避難所マップのアーキテクチャと設計の指針です。

---

## 1. オフラインファースト

- **目的:** 災害時は電波が途絶えやすいため、オフラインでも避難所情報を確認できるようにする。
- **方針:**
  - Service Worker で地図タイル・GeoJSON・アセットをキャッシュする。
  - オンライン時は最新データを取得し、オフライン時はキャッシュを優先して表示する。
  - PWA としてインストール可能にし、アプリのように利用できるようにする。

---

## 2. オープンデータ・オープンソース

- **目的:** データと技術の透明性を保ち、再利用・検証をしやすくする。
- **方針:**
  - 避難所データは国土地理院・国土交通省等のオープンデータを利用する。
  - 地図は MapLibre（OSS）とオープンなタイルソースを使用する。
  - 本プロジェクトは MIT ライセンスで公開する。

---

## 3. 型安全と品質

- **目的:** バグを減らし、リファクタリングを安全に行う。
- **方針:**
  - TypeScript の strict モードを有効にし、`any` を避ける。
  - Biome で Lint とフォーマットを統一する。
  - コミット前に `pnpm lint` と `pnpm type-check` を実行する（AGENTS.md に記載）。

---

## 4. アクセシビリティと視認性

- **目的:** 誰でも使いやすく、災害時でも情報を確実に伝える。
- **方針:**
  - セマンティック HTML と ARIA を適切に使う。
  - キーボード操作・スクリーンリーダーを考慮する。
  - **ダークモードは提供しない。** 災害時の視認性とコントラストを優先し、ライトテーマのみとする（プロジェクト方針で決定）。

---

## 5. シンプルな UX

- **目的:** 緊急時に迷わず使えるようにする。
- **方針:**
  - 画面構成と操作をシンプルに保つ。
  - 災害種別フィルタ・距離順ソート・ルート案内など、必要な機能に絞る。
  - モバイルファーストで設計する。

---

## 6. 自動更新と運用性

- **目的:** 避難所データをできるだけ新しい状態に保つ。
- **方針:**
  - GitHub Actions で定期的にデータ取得・検証・PR 作成を行う。
  - デプロイは Cloudflare Pages の自動ビルドに任せ、手作業を減らす。

---

## 関連ドキュメント

- [ADR 001: PWA フレームワーク](./adr-001-pwa-framework.md)
- [ADR 002: 地図ライブラリ](./adr-002-map-library.md)
- [AGENTS.md](../../AGENTS.md)（コーディング規約・Git ワークフロー）
