# ADR 002: 地図ライブラリの選定

## ステータス

承認済み

## コンテキスト

避難所の位置を地図上に表示し、ズーム・パン・マーカー表示・オフラインで地図タイルを表示する必要がありました。Mapbox GL JS は人気ですが、商用利用時のライセンスとコストを考慮する必要がありました。

## 決定

**MapLibre GL JS** を採用する。

## 理由

- **オープンソース:** Mapbox GL JS v1 を fork した OSS。ライセンスは BSD-3-Clause で商用利用に制約が少ない。
- **互換性:** Mapbox GL と API が近く、ドキュメント・サンプルを流用しやすい。
- **機能:** ベクトルタイル・Globe 表示・オフラインキャッシュに対応。
- **コスト:** タイル配信を自前または OSM 等で賄えるため、利用量に応じた課金を気にしなくてよい。
- **国土地理院タイル等:** ラスタ/ベクトルともにカスタムソースとして設定可能。

Mapbox GL JS を選ばなかった理由は、無料枠を超えると課金が発生するため、公開サービスとして長期的に運用する方針と合わないと判断したためです。

## 結果

- MapLibre で地図表示・マーカー・コントロールを実装済み。
- Service Worker で地図タイルをキャッシュし、オフライン表示を実現。
- 必要に応じて react-map-gl で React ラッパーを利用可能。

## 関連

- [ADR 001: PWA フレームワーク](./adr-001-pwa-framework.md)
- [設計原則](./design-principles.md)
- [技術スタック](../system/tech-stack.md)
